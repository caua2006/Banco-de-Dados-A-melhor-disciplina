create database exercicio_fixacao;
use exercicio_fixacao;
-- 1) Funções de String: ----------------------------------------------------------------------------------------------------------

-- a) -------------------------------------------------------------------------------------------------------------------
create table nomes(
	nome varchar(100)
);
insert into nomes values("Roberta"),("Roberto"),("Maria Clara"),("João");
-- b) -------------------------------------------------------------------------------------------------------------------
select upper(nome) from nomes;
-- c) -------------------------------------------------------------------------------------------------------------------
SELECT 
    LENGTH(nome)
FROM
    nomes;
-- d) -------------------------------------------------------------------------------------------------------------------
SELECT 
    CASE
        WHEN nome LIKE '%a' THEN CONCAT('Sra.', nome)
        ELSE CONCAT('Sr.', nome)
    END AS Sra_ou_Sr
FROM nomes;


-- 2) Funções Numéricas: ----------------------------------------------------------------------------------------------------------

-- a) -------------------------------------------------------------------------------------------------------------------
create table produtos(
	produto varchar(100),
    preco float,
    quantidade integer
);
insert into produtos values("Jordan 4",1234.89,56),("Lebron 13",899.99,90),("CJR IV MVP",3000.00,15),("Jordan 36",699.99,49);
select * from produtos;
-- b) -------------------------------------------------------------------------------------------------------------------
select round(avg(preco),2) from produtos;
-- c) -------------------------------------------------------------------------------------------------------------------
select abs(quantidade) from produtos;
-- d) -------------------------------------------------------------------------------------------------------------------
select round(avg(preco),2) from produtos;

-- 3) Funções de Data: -------------------------------------------------------------------------------------------------

-- a) -------------------------------------------------------------------------------------------------------------------
create table eventos(
	data_evento datetime
);
insert into eventos values("2022-03-16 23:26:55");
select * from eventos;
-- b) -------------------------------------------------------------------------------------------------------------------
insert into eventos values(now());
-- c) -------------------------------------------------------------------------------------------------------------------
select datediff(now(),"2006-08-12");
-- d) ------------------------------------------------------------------------------------------------------------------
select dayname(data_evento) from eventos;

-- 4) Funções de Controle de Fluxo: -------------------------------------------------------------------------------------------------

-- a) -------------------------------------------------------------------------------------------------------------------
select IF(quantidade < 1,"Fora de estoque","Em estoque") from produtos;
-- b) -------------------------------------------------------------------------------------------------------------------
SELECT 
    CASE
        WHEN preco < 800 THEN "Barato"
        WHEN preco > 800 && preco < 1300 THEN "Médio" 
        ELSE  "Caro"
    END AS Clafificacao
FROM produtos;
-- 4)  Função Personalizada: -------------------------------------------------------------------------------------------------






